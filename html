<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rony Money Management | Taka Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
            color: #1e293b;
        }

        /* Glassmorphism for cards */
        .glass-panel {
            background: white;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Print Styles */
        @media print {
            body { background: white; padding: 0; }
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            .glass-panel { box-shadow: none; border: none; }
            table { width: 100%; border-collapse: collapse; font-size: 12px; }
            th, td { border: 1px solid #000; padding: 8px; }
            .print-header { margin-bottom: 20px; border-bottom: 2px solid #000; padding-bottom: 10px; }
        }

        .print-only { display: none; }
    </style>
</head>
<body class="p-4 md:p-6 lg:p-8 min-h-screen">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 no-print">
            <div>
                <h1 class="text-3xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-emerald-600 text-white p-2 rounded-lg shadow-lg shadow-emerald-200">
                        ৳
                    </span>
                    Rony Money Management
                </h1>
                <p class="text-slate-500 mt-1 text-sm">Personal Wealth Manager</p>
            </div>
            <button onclick="window.print()" class="bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-lg font-medium transition flex items-center gap-2 shadow-lg shadow-slate-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9V2h12v7"></path><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                Print Statement
            </button>
        </header>

        <!-- Stats Overview -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8 no-print">
            <div class="glass-panel p-6 rounded-2xl border-l-4 border-emerald-500 relative overflow-hidden group">
                <div class="absolute right-0 top-0 opacity-5 transform translate-x-2 -translate-y-2 group-hover:scale-110 transition">
                    <svg width="100" height="100" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.78-1.74-2.59-1.74-1.94 0-2.13 1.12-2.13 1.54 0 .95.96 1.47 2.63 1.87 2.44.57 4.14 1.62 4.14 3.58 0 1.74-1.34 2.82-3 3.2z"/></svg>
                </div>
                <p class="text-sm font-semibold text-slate-400 uppercase tracking-wider">Net Balance</p>
                <h2 id="total-balance" class="text-3xl font-bold text-slate-800 mt-2">৳0</h2>
            </div>
            <div class="glass-panel p-6 rounded-2xl border-l-4 border-blue-500">
                <p class="text-sm font-semibold text-slate-400 uppercase tracking-wider">Total Income</p>
                <h2 id="total-deposits" class="text-3xl font-bold text-blue-600 mt-2">৳0</h2>
            </div>
            <div class="glass-panel p-6 rounded-2xl border-l-4 border-rose-500">
                <p class="text-sm font-semibold text-slate-400 uppercase tracking-wider">Total Expenses</p>
                <h2 id="total-expenses" class="text-3xl font-bold text-rose-600 mt-2">৳0</h2>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 no-print">
            
            <!-- INPUT FORM -->
            <div class="lg:col-span-4">
                <div class="glass-panel p-6 rounded-2xl sticky top-6">
                    <h3 class="text-lg font-bold mb-5 text-slate-800 border-b pb-2">Add New Entry</h3>
                    <form id="transaction-form" class="space-y-4">
                        
                        <!-- Transaction Type -->
                        <div class="grid grid-cols-2 gap-3">
                            <label class="cursor-pointer">
                                <input type="radio" name="type" value="deposit" class="peer sr-only" checked onchange="setType('deposit')">
                                <div class="text-center py-2 rounded-lg border border-slate-200 peer-checked:bg-emerald-50 peer-checked:border-emerald-500 peer-checked:text-emerald-700 font-medium transition hover:bg-slate-50">
                                    Income (+)
                                </div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="type" value="expense" class="peer sr-only" onchange="setType('expense')">
                                <div class="text-center py-2 rounded-lg border border-slate-200 peer-checked:bg-rose-50 peer-checked:border-rose-500 peer-checked:text-rose-700 font-medium transition hover:bg-slate-50">
                                    Expense (-)
                                </div>
                            </label>
                        </div>

                        <!-- Amount & Date -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 mb-1">Amount (৳)</label>
                                <input type="number" id="amount" required min="0" step="any" placeholder="0" 
                                    class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition font-mono text-lg">
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 mb-1">Date</label>
                                <input type="date" id="date" required 
                                    class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-emerald-500 outline-none transition">
                            </div>
                        </div>

                        <!-- Category -->
                        <div>
                            <label class="block text-xs font-semibold text-slate-500 mb-1">Category / Purpose</label>
                            <input type="text" id="category" required placeholder="e.g. Salary, Rent, Grocery" 
                                class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-emerald-500 outline-none transition">
                        </div>

                        <!-- Extra Info Grid -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 mb-1">Payment Method</label>
                                <select id="method" class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-emerald-500 outline-none bg-white">
                                    <option value="Cash">Cash</option>
                                    <option value="bKash">bKash</option>
                                    <option value="Nagad">Nagad</option>
                                    <option value="Rocket">Rocket</option>
                                    <option value="Bank">Bank Transfer</option>
                                    <option value="Card">Credit/Debit Card</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 mb-1">Status</label>
                                <select id="status" class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-emerald-500 outline-none bg-white">
                                    <option value="Completed">Completed</option>
                                    <option value="Pending">Pending</option>
                                </select>
                            </div>
                        </div>

                        <!-- Notes -->
                        <div>
                            <label class="block text-xs font-semibold text-slate-500 mb-1">Notes (Optional)</label>
                            <textarea id="notes" rows="2" placeholder="More details..." 
                                class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-emerald-500 outline-none transition resize-none text-sm"></textarea>
                        </div>

                        <button id="submit-btn" type="submit" class="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-3 rounded-lg transition shadow-lg mt-2 flex justify-center items-center gap-2">
                            <span>Add Transaction</span>
                        </button>
                    </form>
                </div>
            </div>

            <!-- TABLE LIST -->
            <div class="lg:col-span-8">
                <div class="glass-panel rounded-2xl overflow-hidden min-h-[500px] flex flex-col">
                    <div class="p-5 border-b border-slate-100 bg-white flex justify-between items-center">
                        <h3 class="text-lg font-bold text-slate-800">Recent Transactions</h3>
                        <button onclick="clearAllData()" class="text-xs text-rose-500 hover:text-rose-700 hover:underline">Clear All Data</button>
                    </div>
                    
                    <div class="overflow-x-auto flex-grow">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-slate-50 text-slate-500 text-xs uppercase font-semibold">
                                <tr>
                                    <th class="px-5 py-3">Date</th>
                                    <th class="px-5 py-3">Category/Notes</th>
                                    <th class="px-5 py-3">Method</th>
                                    <th class="px-5 py-3 text-right">Amount</th>
                                    <th class="px-5 py-3 text-center">Action</th>
                                </tr>
                            </thead>
                            <tbody id="transaction-body" class="divide-y divide-slate-100 bg-white text-sm">
                                <!-- Data rows injected here -->
                            </tbody>
                        </table>
                        
                        <!-- Empty State -->
                        <div id="empty-state" class="hidden flex-col items-center justify-center h-64 text-slate-400">
                            <svg class="w-16 h-16 mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            <p>No records found.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PRINT PREVIEW LAYOUT -->
        <div class="print-only max-w-4xl mx-auto">
            <div class="print-header flex justify-between items-end">
                <div>
                    <h1 class="text-2xl font-bold uppercase tracking-wide">Financial Statement</h1>
                    <p class="text-sm text-gray-600 mt-1">Generated via Rony Money Management</p>
                </div>
                <div class="text-right">
                    <p class="text-sm">Date: <span id="print-date" class="font-bold"></span></p>
                </div>
            </div>

            <!-- Print Summary -->
            <div class="flex gap-4 mb-6 text-sm">
                <div class="border p-3 w-1/3">
                    <span class="block text-gray-500">Total Income</span>
                    <strong class="text-lg" id="p-income">৳0.00</strong>
                </div>
                <div class="border p-3 w-1/3">
                    <span class="block text-gray-500">Total Expense</span>
                    <strong class="text-lg" id="p-expense">৳0.00</strong>
                </div>
                <div class="border p-3 w-1/3 bg-gray-50">
                    <span class="block text-gray-500">Net Balance</span>
                    <strong class="text-lg" id="p-balance">৳0.00</strong>
                </div>
            </div>

            <table>
                <thead>
                    <tr class="bg-gray-100">
                        <th class="text-left w-24">Date</th>
                        <th class="text-left">Details</th>
                        <th class="text-left w-24">Method</th>
                        <th class="text-left w-20">Status</th>
                        <th class="text-right w-28">Credit (৳)</th>
                        <th class="text-right w-28">Debit (৳)</th>
                    </tr>
                </thead>
                <tbody id="print-body">
                    <!-- Print Rows -->
                </tbody>
            </table>

            <div class="mt-16 flex justify-between items-center text-xs text-gray-500">
                <p>This is a computer generated document.</p>
                <div class="text-center w-40">
                    <div class="border-b border-black h-8 mb-1"></div>
                    <p>Authorized Signature</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Logic -->
    <script>
        // State
        let transactions = JSON.parse(localStorage.getItem('bdFinanceData')) || [];
        let currentType = 'deposit';

        // Elements
        const form = document.getElementById('transaction-form');
        const dateInput = document.getElementById('date');
        const submitBtn = document.getElementById('submit-btn');

        // Set default date
        dateInput.valueAsDate = new Date();

        // Helpers
        const formatTaka = (num) => {
            return '৳' + parseFloat(num).toLocaleString('en-BD', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
        };

        function setType(type) {
            currentType = type;
            const btn = document.getElementById('submit-btn');
            if(type === 'deposit') {
                btn.className = "w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 rounded-lg transition shadow-lg mt-2 flex justify-center items-center gap-2";
                btn.innerText = "Add Income";
            } else {
                btn.className = "w-full bg-rose-600 hover:bg-rose-700 text-white font-bold py-3 rounded-lg transition shadow-lg mt-2 flex justify-center items-center gap-2";
                btn.innerText = "Add Expense";
            }
        }

        function saveToLocal() {
            localStorage.setItem('bdFinanceData', JSON.stringify(transactions));
        }

        function clearAllData() {
            if(confirm('Are you sure you want to delete all records? This cannot be undone.')) {
                transactions = [];
                saveToLocal();
                render();
            }
        }

        function deleteTransaction(id) {
            if(confirm('Delete this entry?')) {
                transactions = transactions.filter(t => t.id !== id);
                saveToLocal();
                render();
            }
        }

        function render() {
            const tbody = document.getElementById('transaction-body');
            const pbody = document.getElementById('print-body');
            const emptyState = document.getElementById('empty-state');
            
            tbody.innerHTML = '';
            pbody.innerHTML = '';

            // Sort: Newest first
            const sorted = [...transactions].sort((a, b) => new Date(b.date) - new Date(a.date));

            let totalInc = 0;
            let totalExp = 0;

            if (sorted.length === 0) {
                emptyState.classList.remove('hidden');
                emptyState.classList.add('flex');
            } else {
                emptyState.classList.add('hidden');
                emptyState.classList.remove('flex');
            }

            sorted.forEach(t => {
                const amt = parseFloat(t.amount);
                const isInc = t.type === 'deposit';
                
                if(isInc) totalInc += amt;
                else totalExp += amt;

                // --- Dashboard Row ---
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 group transition";
                
                // Status Badge color
                const statusColor = t.status === 'Completed' ? 'bg-blue-100 text-blue-700' : 'bg-orange-100 text-orange-700';
                
                // Method Icon
                let methodBadge = `<span class="px-2 py-0.5 rounded text-xs bg-slate-100 text-slate-600 border border-slate-200">${t.method}</span>`;
                if(t.method === 'bKash') methodBadge = `<span class="px-2 py-0.5 rounded text-xs bg-pink-100 text-pink-600 border border-pink-200 font-bold">bKash</span>`;
                if(t.method === 'Nagad') methodBadge = `<span class="px-2 py-0.5 rounded text-xs bg-orange-100 text-orange-600 border border-orange-200 font-bold">Nagad</span>`;

                tr.innerHTML = `
                    <td class="px-5 py-4 text-slate-600 whitespace-nowrap">${t.date}</td>
                    <td class="px-5 py-4">
                        <div class="font-medium text-slate-800">${t.category}</div>
                        ${t.notes ? `<div class="text-xs text-slate-400 mt-0.5 truncate max-w-[200px]">${t.notes}</div>` : ''}
                    </td>
                    <td class="px-5 py-4 text-xs">
                        <div class="flex flex-col gap-1 items-start">
                            ${methodBadge}
                            <span class="text-[10px] ${statusColor} px-1.5 rounded">${t.status}</span>
                        </div>
                    </td>
                    <td class="px-5 py-4 text-right font-bold ${isInc ? 'text-emerald-600' : 'text-rose-600'}">
                        ${isInc ? '+' : '-'} ${amt.toLocaleString()}
                    </td>
                    <td class="px-5 py-4 text-center">
                        <button onclick="deleteTransaction('${t.id}')" class="text-slate-300 hover:text-rose-500 p-2 rounded hover:bg-rose-50 transition">
                            <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);

                // --- Print Row ---
                const ptr = document.createElement('tr');
                ptr.innerHTML = `
                    <td>${t.date}</td>
                    <td>
                        <div class="font-bold">${t.category}</div>
                        <div class="text-xs text-gray-500">${t.notes || ''}</div>
                    </td>
                    <td>${t.method}</td>
                    <td class="text-xs">${t.status}</td>
                    <td class="text-right text-gray-800">${isInc ? formatTaka(amt) : '-'}</td>
                    <td class="text-right text-gray-800">${!isInc ? formatTaka(amt) : '-'}</td>
                `;
                pbody.appendChild(ptr);
            });

            // Update Summaries
            const net = totalInc - totalExp;
            
            document.getElementById('total-balance').textContent = formatTaka(net);
            document.getElementById('total-deposits').textContent = formatTaka(totalInc);
            document.getElementById('total-expenses').textContent = formatTaka(totalExp);

            // Print Summaries
            document.getElementById('p-income').textContent = formatTaka(totalInc);
            document.getElementById('p-expense').textContent = formatTaka(totalExp);
            document.getElementById('p-balance').textContent = formatTaka(net);
            document.getElementById('print-date').textContent = new Date().toLocaleDateString();
        }

        // Form Submit
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const item = {
                id: Date.now().toString(),
                type: currentType,
                amount: document.getElementById('amount').value,
                date: document.getElementById('date').value,
                category: document.getElementById('category').value,
                method: document.getElementById('method').value,
                status: document.getElementById('status').value,
                notes: document.getElementById('notes').value
            };

            transactions.push(item);
            saveToLocal();
            render();
            
            // Reset form but keep date
            const currDate = document.getElementById('date').value;
            form.reset();
            document.getElementById('date').value = currDate;
            
            // Restore correct button state
            setType(currentType); 
        });

        // Initialize
        render();
        setType('deposit'); // visual init

    </script>
</body>
</html>
